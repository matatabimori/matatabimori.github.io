<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="utf-8">
  
  <title>QGIS安装程序+开发库中遇到的问题 | Angie</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="根据基于QGis二次开发创建自定义程序–环境搭建依次完成以下步骤：    安装QGIS软件   安装二次开发需要的库文件   将附加依赖库添加进QGIS安装目录   在VS2019配置编译环境   配置环境变量   创建测试工程   配置附加包含目录、附加库目录、附加依赖项   将工程需要的dll文件添加到工程目录  其中需要注意的问题：  1. Qt VS Tools新版本中没有Qt GUI A">
<meta property="og:type" content="article">
<meta property="og:title" content="QGIS安装程序+开发库中遇到的问题">
<meta property="og:url" content="http://example.com/2021/06/08/QGIS%E5%AE%89%E8%A3%85%E7%A8%8B%E5%BA%8F+%E5%BC%80%E5%8F%91%E5%BA%93/index.html">
<meta property="og:site_name" content="Angie">
<meta property="og:description" content="根据基于QGis二次开发创建自定义程序–环境搭建依次完成以下步骤：    安装QGIS软件   安装二次开发需要的库文件   将附加依赖库添加进QGIS安装目录   在VS2019配置编译环境   配置环境变量   创建测试工程   配置附加包含目录、附加库目录、附加依赖项   将工程需要的dll文件添加到工程目录  其中需要注意的问题：  1. Qt VS Tools新版本中没有Qt GUI A">
<meta property="og:locale">
<meta property="og:image" content="https://i.loli.net/2021/06/08/KRtZA8ve31pXUFL.png">
<meta property="og:image" content="https://i.loli.net/2021/06/08/NZ7olMcvaesiq5D.png">
<meta property="og:image" content="https://i.loli.net/2021/06/08/3QeoGVCfqnEO2IT.png">
<meta property="og:image" content="https://i.loli.net/2021/06/10/fuJ6PrhsIOKE7HM.png">
<meta property="article:published_time" content="2021-06-08T09:35:48.591Z">
<meta property="article:modified_time" content="2021-06-10T05:53:01.263Z">
<meta property="article:author" content="matatabimori">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2021/06/08/KRtZA8ve31pXUFL.png">
  
  
    <link rel="shortcut icon" href="/favicon.ico">
  
  
<link rel="stylesheet" href="/css/typing.css">

  
<link rel="stylesheet" href="/css/donate.css">

  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.0"></head>

  
    
      <body>
    
  
      <div id="container" class="container">
        <article id="post-QGIS安装程序+开发库" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <header id="header" class="header">
  <nav class="mobile-nav">
    <h1 class="nickname">Angie</h1>
    <ul class="mobile-nav-menu">
      <label for="mobile-menu-toggle"><a id="menu-button">&#9776; Menu</a></label>
      <input type="checkbox" id="mobile-menu-toggle"/>
      <ul class="mobile-nav-link">
        
        <a href="/">Home</a>
        
        <a href="/archives">Archives</a>
        
        <a href="/about">About</a>
        
      </ul>
    </ul>
  </nav>
	
		<nav id="main-nav" class="main-nav nav-left">
	
	
	  <a class="main-nav-link" href="/">Home</a>
	
	  <a class="main-nav-link" href="/archives">Archives</a>
	
	  <a class="main-nav-link" href="/about">About</a>
	
  </nav>
</header>

  <hr/>
  <div class="article-inner">
    

    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      QGIS安装程序+开发库中遇到的问题
    </h1>
  

      </header>
    
    <div class="e-content article-entry typo" itemprop="articleBody">
      
        <p>根据<a target="_blank" rel="noopener" href="https://blog.csdn.net/xiaobaiqing1983/article/details/105403838">基于QGis二次开发创建自定义程序–环境搭建</a>依次完成以下步骤：</p>
<ul>
<li>  安装QGIS软件</li>
<li>  安装二次开发需要的库文件</li>
<li>  将附加依赖库添加进QGIS安装目录</li>
<li>  在VS2019配置编译环境</li>
<li>  配置环境变量</li>
<li>  创建测试工程</li>
<li>  配置附加包含目录、附加库目录、附加依赖项</li>
<li>  将工程需要的dll文件添加到工程目录</li>
</ul>
<p>其中需要注意的问题：</p>
<p> <strong>1. Qt VS Tools新版本中没有Qt GUI Application</strong><br>网上二次开发的教程在创建新项目时都选择VS中的Qt GUI Application模板，但最新版本（2.7.xx）版本没有这个模板，此为插件版本问题，可以先卸载了在VS上安装的插件，再在<a target="_blank" rel="noopener" href="https://download.qt.io/official_releases/vsaddin/">官网下载</a>较低版本就可以使用，我用的是<a target="_blank" rel="noopener" href="https://download.qt.io/official_releases/vsaddin/2.4.3/qt-vsaddin-msvc2019-2.4.3.vsix">qt-vsaddin-msvc2019-2.4.3.vsix</a>，安装完后就能创建Qt GUI Application项目。<br>但是需要注意在扩展-管理扩展-更改扩展的设置中取消掉自动检查更新的勾选框，不然每次都会给你自动更新。<br><img src="https://i.loli.net/2021/06/08/KRtZA8ve31pXUFL.png" alt="enter image description here"></p>
<p><strong>2. 无法打开源文件 “ui_QtGuiApplication2.h”</strong><br>安装好Qt VS Tools插件后发现有无法打开ui_QtGuiApplication2.h的错误。<br>解决方案：<br>在工具-外部工具中配置uic编译工具<br><img src="https://i.loli.net/2021/06/08/NZ7olMcvaesiq5D.png" alt="enter image description here"><br>如图所示，编译cpp文件后得到了ui_QtGuiApplication2.h在工程文件夹里，将它添加到工程即可。</p>
<p><strong>3. 拷贝Qt资源文件</strong><br>在创建可执行文件后运行程序会报缺少很多dll文件的错误，因为需要将Qt5依赖的文件拷贝到项目文件目录下（D:\BOOKS\VSProject\QtGuiApplication2\x64\Release）。<br>这一步需要用到Qt5自带的“windeployqt.exe”程序，可以像原博客一样写一个py脚本拷贝资源，但那样比较麻烦，可以用如下方法添加：</p>
<ol>
<li>从目录“D:\QGIS_3.16\apps\qt5\bin”中拷贝windeployqt.exe文件到工程目录下，把它和工程生成的QtGuiApplication2.exe文件放在一起。</li>
<li>其次，把“D:\QGIS_3.16\apps\qt5\bin”添加到系统的环境变量的path中，重启电脑。</li>
<li>打开VS 2019开发人员cmd窗口，输入命令windeployqt [exe文件的路径]，比如我的是“windeployqt D:\BOOKS\VSProject\QtGuiApplication2\x64\Release\QtGuiApplication2.exe”，按下回车就完成了资源拷贝。如图所示：<br><img src="https://i.loli.net/2021/06/08/3QeoGVCfqnEO2IT.png" alt="enter image description here"></li>
</ol>
<p><strong>4. 运行时报错：无法定位程序输入点…于动态链接库…</strong><br>按理来说完成以上步骤就能完成环境搭建，查了下网上说这个报错有可能时环境变量冲突，有可能是dll文件和lib文件版本不一致，还有可能是各种玄学原因。<br>正在排查，初步可以确定不是我电脑上环境变量的问题。<br><img src="https://i.loli.net/2021/06/10/fuJ6PrhsIOKE7HM.png" alt="enter image description here"><br>遇到这个问题后用了很久的时间排查，还是没有得到解决，<strong>于是决定放弃使用QGIS安装程序+开发库的方式进行开发，转而使用官方的二次开发库。</strong></p>

      
      
    </div>
    <footer class="article-footer">
      <ul class="article-meta">
        <li>
          <span class="label">Published Date:</span>
          <a href="/2021/06/08/QGIS%E5%AE%89%E8%A3%85%E7%A8%8B%E5%BA%8F+%E5%BC%80%E5%8F%91%E5%BA%93/" class="article-date">
  <time class="dt-published" datetime="2021-06-08T09:35:48.591Z" itemprop="datePublished">2021-06-08</time>
</a>

        </li>
        
        
        <hr/>
      </ul>
    </footer>
  </div>
  
    
<nav id="article-nav" class="article-nav">
  
    <a href="/2021/06/10/QGIS%E5%BC%80%E5%8F%91%E5%BA%93+VS2019%E6%90%AD%E5%BB%BA%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/" id="article-nav-newer" class="article-nav-link-wrap newer">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          VS2019+QGIS开发库二次开发环境搭建
        
      </div>
    </a>
  
  
    <a href="/2021/05/25/QGIS%E5%9C%A8VS2019%E7%BC%96%E8%AF%91%E4%B8%AD%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/" id="article-nav-older" class="article-nav-link-wrap older">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">QGIS+VS2019编译中遇到的问题</div>
    </a>
  
</nav>


  
</article>










      </div>
      
    <footer id="footer" class="post-footer footer">
      
      <hr/>
      <div id="footerContent" class="footer-content">
        <p>來自我的甜蜜夢鄉</p>


      </div>
    </footer>

      








<script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>


<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>



  
<script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>




<script src="/js/typing.js"></script>

<!--[if lt IE 9]>
<script src="https://cdn.jsdelivr.net/npm/html5shiv@3/dist/html5shiv.min.js"></script>
<![endif]-->







    </div>
  </body>
</html>
